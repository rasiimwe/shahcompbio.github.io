
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>citup | Shah Lab</title>
    
    <meta name="author" content="Sohrab P. Shah">

    <!-- Enable responsive viewport -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>

    <!-- Bootstrap styles -->
    <link href="/assets/themes/lab/bootstrap/css/bootstrap.min.css" rel="stylesheet"/>
    <!-- Optional theme -->
    <link href="/assets/themes/lab/bootstrap/css/bootstrap-theme.min.css" rel="stylesheet"/>
    <!-- Sticky Footer -->
    <link href="/assets/themes/lab/bootstrap/css/bs-sticky-footer.css" rel="stylesheet"/>
    
    <!-- Custom styles -->
    <link href="/assets/themes/lab/css/style.css?body=1" rel="stylesheet" type="text/css" media="all"/>

    <!-- icon -->
    <link rel="icon" type="image/png" href="/assets/themes/lab/images/logo/favicon.png"/>

    <!-- Custom fonts and icons via Font Awesome, http://fortawesome.github.io/Font-Awesome/ -->
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css"/>

    <!-- Fonts via Google -->
    <link href='http://fonts.googleapis.com/css?family=Lato:300italic,700italic,300,700' rel='stylesheet' type='text/css'/>

    <!-- Math via MathJax -->
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>


    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <!-- Fav and touch icons -->
    <!-- Update these with your own images
      <link rel="shortcut icon" href="images/favicon.ico">
      <link rel="apple-touch-icon" href="images/apple-touch-icon.png">
      <link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
      <link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
    -->

    <!-- atom & rss feed
    <link href="/atom.xml" type="application/atom+xml" rel="alternate" title="Sitewide ATOM Feed">
    <link href="/rss.xml" type="application/rss+xml" rel="alternate" title="Sitewide RSS Feed">
    -->

  </head>

  <body>

  <!-- Static top navbar -->

  <nav class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class='container'>
      <!-- Brand and toggle get grouped for better mobile display -->
      <div class="navbar-header">
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#jb-navbar-collapse">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a href="/">
        <img class="pull-left logo" src="/assets/themes/lab/images/logo/lab-logo.svg" type="image/svg+xml">
        </a>
      </div>

      <!-- Collect the nav links, forms, and other content for toggling -->
      <div class="collapse navbar-collapse" id="jb-navbar-collapse">
        <ul class="nav navbar-nav navbar-left hidden-sm">
          <!-- Don't put site title on home page -- there's already a big title there. -->
          
          
          
          <a class="navbar-brand" href="/">Shah Lab</a>
          
        </ul>
        <ul class="nav navbar-nav navbar-right pull-right">
          
          
          


  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
  
    
  
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
  
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/research">Research</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/blog/">Blog</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/papers/">Papers</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/projects/">Software</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/team/">Team</a></li>
      	
      
    
  



          <!--<li class="dropdown nav navbar-nav">-->
            <!--<a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">-->
              <!--More <span class="caret"></span>-->
            <!--</a>-->

            <!--<ul class="dropdown-menu nav navbar-nav" role="menu">-->
              <!---->
              <!---->
              <!--


  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
  
    
  
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
  
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  


-->
            <!--</ul>-->
          <!--</li>-->
        </ul>
      </div><!-- /.navbar-collapse -->
    </nav>
   </div>

   <!-- Content -->
   <div class="container">
      
<div class="page-header">
  <div class="title media-heading">citup</div>
  
</div>

<div class="row post-full">
  <div class="col-xs-12">
    <div class="date">
      <span></span>
    </div>
    <div class="content">
      <p><a href="https://github.com/amcpherson/citup">Fork me on GitHub!</a></p>

<h1 id="citup">Citup</h1>

<p>The following package implements the method described in
<a href="http://dx.doi.org/10.1093/bioinformatics/btv003">Clonality inference in multiple tumor samples using phylogeny</a></p>

<p>Citup estimates the clone phylogeny and clonal genotypes for deep sequencing of SNVs in multiple tumour biopsies.
The input are cellular frequencies of mutations as estimated from the deep sequencing data.  The method infers an
evolutionary tree, and an assignment of mutations to nodes in the tree.</p>

<h2 id="installation">Installation</h2>

<p>The supported installation method for citup is using <a href="http://conda.pydata.org/docs/">conda</a>.  If you do not already
use conda, we recommend installing <a href="https://www.continuum.io/downloads">anaconda</a> or
<a href="http://conda.pydata.org/miniconda.html">miniconda</a>.</p>

<p>You will need to add my conda channel using:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>conda config --add channels http://conda.anaconda.org/dranew
</code></pre>
</div>

<p>Cplex is required to run citup.  For licensing reasons this could not be included in my public conda repo.
A license is required and is free for academic use.  The recommended installation procedure involves building
and installing cplex using conda.  A <a href="https://bitbucket.org/dranew/conda_recipes/src">conda build recipe for cplex</a>
is provided.</p>

<p>With cplex installed you should be able to type:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>conda install citup
</code></pre>
</div>

<h2 id="usage">Usage</h2>

<h3 id="citup-iter">Citup Iter</h3>

<p>To run the iterative version of citup, provide a table of frequencies.  The input format is tab/whitespace separated, with each row
representing the frequency of a mutation and each column is a tumour sample.  No header is required.</p>

<p>For example, the following would be input for 3 mutations in 2 samples.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>0.2 0.1
0.4 0.3
0.5 0.1
</code></pre>
</div>

<p>Given mutation frequences <code class="highlighter-rouge">freq.txt</code>, run citup iter using the following command.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>run_citup_iter.py freq.txt results.h5
</code></pre>
</div>

<p>The above command will run citup iter and produce results in pandas hdf5 format in <code class="highlighter-rouge">results.h5</code>.</p>

<p>For additional options run <code class="highlighter-rouge">run_citup_iter.py -h</code>.</p>

<h3 id="citup-qip">Citup QIP</h3>

<p>To run the QIP version of citup, provide a table of mutation frequencies, and a table of mutation clusters.
The input format for mutation frequencies is described above.  The mutation clusters is a single line per mutation,
containing a 0 based integer cluster index for that mutation.  For example, the following specifies 3 mutations, the
first two in the same cluster the last in a different cluster.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>0
0
1
</code></pre>
</div>

<p>Given mutation frequences <code class="highlighter-rouge">freq.txt</code> and mutation clusters <code class="highlighter-rouge">clusters.txt</code> run citup QIP using the following command.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>run_citup_qip.py freq.txt clusters.txt results.h5
</code></pre>
</div>

<p>The above command will run citup iter and produce results in pandas hdf5 format in <code class="highlighter-rouge">results.h5</code>.</p>

<p>For additional options run <code class="highlighter-rouge">run_citup_qip.py -h</code>.</p>

<h2 id="output-format">Output Format</h2>

<p>The output of citup is <a href="http://pandas.pydata.org/pandas-docs/version/0.18.0/generated/pandas.read_hdf.html">pandas hdf5</a> format.</p>

<p>The results store contains the following pandas series, with an entry per tree solution:</p>

<ul>
  <li><code class="highlighter-rouge">/results/bic</code></li>
  <li><code class="highlighter-rouge">/results/error_rate</code></li>
  <li><code class="highlighter-rouge">/results/likelihood</code></li>
  <li><code class="highlighter-rouge">/results/num_mutations</code></li>
  <li><code class="highlighter-rouge">/results/num_nodes</code></li>
  <li><code class="highlighter-rouge">/results/num_samples</code></li>
  <li><code class="highlighter-rouge">/results/objective_value</code></li>
  <li><code class="highlighter-rouge">/results/optimal</code></li>
  <li><code class="highlighter-rouge">/results/tree_id</code></li>
  <li><code class="highlighter-rouge">/results/tree_index</code></li>
  <li><code class="highlighter-rouge">/results/tree_string</code></li>
</ul>

<p>The store also contains the following pandas series, with one series per tree solution:</p>

<ul>
  <li><code class="highlighter-rouge">/trees/{tree_solution}/cluster_assignment</code></li>
  <li><code class="highlighter-rouge">/trees/{tree_solution}/objective_value</code></li>
</ul>

<p>Finally, the store contains the following pandas dataframes, with one frame per tree solution:</p>

<ul>
  <li><code class="highlighter-rouge">/trees/{tree_solution}/adjacency_list</code></li>
  <li><code class="highlighter-rouge">/trees/{tree_solution}/clade_freq</code></li>
  <li><code class="highlighter-rouge">/trees/{tree_solution}/clone_freq</code></li>
  <li><code class="highlighter-rouge">/trees/{tree_solution}/gamma_matrix</code></li>
</ul>


    </div>

  <!-- 
    <ul class="tag_box inline">
      <li><i class="glyphicon glyphicon-open"></i></li>
      
      


  
    
  


    </ul>
    

  
    <ul class="tag_box inline">
      <li><i class="glyphicon glyphicon-tags"></i></li>
      
      


  
    
  



    </ul>
   -->  
  
    <hr>
    
  </div>
</div>


   </div>


  <!-- Static bottom navbar -->
  <nav class="navbar navbar-default navbar-fixed-bottom">
    <div class="container">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#jb-bottom-collapse"> <!-- NOTE! data-target was changed to jb-bottom-collapse -->
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
      </div>
      <!-- Collect the nav links, forms, and other content for toggling -->
      <div class="collapse navbar-collapse" id="jb-bottom-collapse">
        <a href=http://molonc.bccrc.ca>
          <img class="logo" alt="BCCA Molecular Oncology" src=/assets/images/bcca_logo.png>
        </a>
        <a href=http://www.ubc.ca/>
          <img class="logo" alt="UBC" src=/assets/images/4_2016_UBCLogo_BlueRGB72.png>
        </a>
        <ul class="nav navbar-nav navbar-right navbar-small">
          <li><a href='/about.html'>About</a></li>
          <li><a href='/join.html'>Join</a></li>
          <li><a href='/contact.html'>Contact</a></li>
        </ul>
      </div><!-- /.navbar-collapse -->
    </div>
  </nav>

    




  <script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-103919622-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>




    <!-- Latest compiled and minified JavaScript, requires jQuery 1.x (2.x not supported in IE8) -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
    <script src="/assets/themes/lab/bootstrap/js/bootstrap.min.js"></script>
    <script type='text/javascript' src='https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js'></script>
  </body>
</html>

